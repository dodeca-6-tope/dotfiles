# Editor & tools
[core]
	editor = code --wait
	pager = delta
[diff]
	tool = vscode
[difftool]
	prompt = false
[difftool "vscode"]
	cmd = code --wait --diff \"$LOCAL\" \"$REMOTE\"
[merge]
	tool = vscode
[mergetool "vscode"]
	cmd = code --wait --merge \"$LOCAL\" \"$REMOTE\" \"$BASE\" \"$MERGED\"

# Delta
[delta]
	line-numbers = true
	side-by-side = false
	file-style = bold yellow
	hunk-header-style = omit
	file-decoration-style = none

# Aliases
[alias]
	# Status
	s = status -s

	# Stash
	st = stash save -m
	sl = stash list --color=always --pretty=\"%<(14)%Cgreen%cr %C(magenta)%gd %C(blue)%gs\"
	sp = stash pop

	# Commit
	c = commit -a -m
	ca = commit -a --amend --no-edit
	cam = commit -a --amend -m

	# Branch
	ch = checkout
	rb = rebase -i
	re = !git branch --sort=-committerdate | fzf | xargs git checkout

	# Push
	p = push
	pf = push -f

	# Diff
	d = diff
	dc = diff --cached
	di = diff --ignore-all-space
	ds = diff --stat
	dt = "!f() { git diff --name-only \"$@\" | fzf --preview \"git diff $* -- {} | delta --light --paging=never\" --preview-window=bottom:75%:wrap --header \"⏎ difftool | ^d copy path\" --bind \"enter:execute(git difftool -y $* -- {})+reload(git diff --name-only $*)\" --bind \"ctrl-d:execute-silent(echo -n {} | clip)\"; }; f"
	dp = "!f() { pr=$1; data=$(gh pr view $pr --json baseRefOid,headRefOid -q '.baseRefOid + \" \" + .headRefOid'); baseOid=${data%% *}; head=${data##* }; git fetch origin $baseOid $head 2>/dev/null; git dt $(git merge-base $baseOid $head)..$head; }; f"
	dtc = difftool --cached

	# Reset & clean
	r = reset
	rh = reset --hard
	a = add
	cl = clean -fdi

	# Log
	l = "!f() { base=$(git merge-base HEAD origin/develop 2>/dev/null || git merge-base HEAD origin/main 2>/dev/null); upstream=$(git rev-parse --abbrev-ref @{u} 2>/dev/null); if [ -n \"$upstream\" ]; then counts=$(git rev-list --left-right --count HEAD...@{u} 2>/dev/null); ahead=${counts%%\t*}; behind=${counts##*\t}; stats=\"↑$ahead ↓$behind\"; else stats=\"no upstream\"; fi; selected=$(git log $base..HEAD --oneline --abbrev-commit --no-decorate --first-parent --color=always | fzf --ansi --header \"$stats\") && printf \"%s\" \"$(echo \"$selected\" | awk '{print $1}')\" | clip; }; f"

# Credentials (set by `gh auth setup-git`)
